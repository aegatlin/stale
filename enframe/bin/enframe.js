#! /usr/bin/env node

parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"r+/I":[function(require,module,exports) {
"use strict";exports.__esModule=!0;var e=require("./packageJsonMaker"),t=require("../enframe"),r=["typescript","ts-node","@types/node","parcel","express","@types/express","ts-node","react","@types/react","react-dom","@types/react-dom","compression","@types/compression","helmet","@types/helmet","redux-starter-kit","react-redux","@types/react-redux","pg","@types/pg","@aegatlin/pore"],s=["prettier","eslint","eslint-config-prettier","eslint-plugin-prettier","eslint-plugin-react","@typescript-eslint/eslint-plugin","@typescript-eslint/parser","mocha","@types/mocha","enzyme","@types/enzyme","chai","@types/chai","enzyme-adapter-react-16","@types/enzyme-adapter-react-16","chai-enzyme","@types/chai-enzyme","cypress","nodemon"],n=function(r,s,n){var p=Object.keys(n[s]||{}),a=p?r.filter(function(e){return!p.includes(e)}):r;if(a.length){var i="yarn add "+(s==e.Package.Key.DevDependencies?"--dev ":"")+a.join(" ");t.enframeExec(i)}else t.elog(s+" are up to date.")};exports.dependenciesMaker=function(t){n(r,e.Package.Key.Dependencies,t),n(s,e.Package.Key.DevDependencies,t)};
},{"./packageJsonMaker":"/QAH","../enframe":"xsr0"}],"hz+C":[function(require,module,exports) {
"use strict";var t=this&&this.__assign||function(){return(t=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var o in r=arguments[e])Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o]);return t}).apply(this,arguments)},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};exports.__esModule=!0;var e=require("./enframe"),n=r(require("import-fresh")),o=n.default(e.rootDir("enframe.json")),i=t({},o,{appCustomDomain:o.appCustomDomain||null,gtmId:o.gtmId||null});exports.enframeConfig=i;
},{"./enframe":"xsr0"}],"/QAH":[function(require,module,exports) {
"use strict";var e,r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var r,n=1,t=arguments.length;n<t;n++)for(var i in r=arguments[n])Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i]);return e}).apply(this,arguments)},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};exports.__esModule=!0;var t,i=require("fs"),s=require("../enframe"),o=n(require("import-fresh")),a=require("./dependencies"),c=require("../enframeConfig");!function(e){!function(e){e.Name="name",e.Version="version",e.Description="description",e.Scripts="scripts",e.Repository="repository",e.Dependencies="dependencies",e.DevDependencies="devDependencies"}(e.Key||(e.Key={}))}(t=exports.Package||(exports.Package={}));var p=((e={})[t.Key.Name]=c.enframeConfig.appName,e[t.Key.Version]="0.0.1",e[t.Key.Description]=c.enframeConfig.appDescription,e[t.Key.Scripts]={build:"parcel build src/index.html",start:"ts-node src/back/server.ts","watch-front":"parcel src/index.html","watch-back":"nodemon",test:"mocha","integration-test":"./scripts/integration-test.sh",cy:"yarn cypress open",lint:"eslint --ext .ts,.tsx ./"},e[t.Key.Repository]=c.enframeConfig.gitlabRemoteSSH,e[t.Key.Dependencies]={},e[t.Key.DevDependencies]={},e),f=function(){return o.default(s.rootDir("package.json"))};exports.packageJsonMaker=function(){var e=f();a.dependenciesMaker(e),e=f(),e=r({},p,e),i.writeFileSync(s.rootDir("package.json"),JSON.stringify(e,null,2)+"\n")};
},{"../enframe":"xsr0","./dependencies":"r+/I","../enframeConfig":"hz+C"}],"ioA1":[function(require,module,exports) {
"use strict";exports.__esModule=!0;var e=require("./enframe"),t=require("child_process"),i=require("./enframeConfig"),n=i.enframeConfig.gitlabRemoteSSH,r=function(){return e.commandDoesNotError("git status")};exports.gitInit=function(){r()||e.enframeExec("git init")};var o=function(){return!!r()&&!!t.execSync("git status --porcelain",{encoding:"utf8"})},c=function(){return t.execSync("git remote",{encoding:"utf8"}).includes("origin")};exports.gitPush=function(){o()?(e.enframeExec("git add ."),e.enframeExec('git commit -m "Enframe commit."'),c()?e.enframeExec("git push origin master"):(e.enframeExec("git remote add origin "+n),e.enframeExec("git push --set-upstream origin master"))):e.elog("No git changes have been detected. Skipping git-push sequence.")};
},{"./enframe":"xsr0","./enframeConfig":"hz+C"}],"i9Mb":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,r,n,t){return new(n||(n=Promise))(function(o,a){function u(e){try{c(t.next(e))}catch(r){a(r)}}function i(e){try{c(t.throw(e))}catch(r){a(r)}}function c(e){e.done?o(e.value):new n(function(r){r(e.value)}).then(u,i)}c((t=t.apply(e,r||[])).next())})},r=this&&this.__generator||function(e,r){var n,t,o,a,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,t&&(o=2&a[0]?t.return:a[0]?t.throw||((o=t.return)&&o.call(t),0):t.next)&&!(o=o.call(t,a[1])).done)return o;switch(t=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return u.label++,{value:a[1],done:!1};case 5:u.label++,t=a[1],a=[0];continue;case 7:a=u.ops.pop(),u.trys.pop();continue;default:if(!(o=(o=u.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){u=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){u.label=a[1];break}if(6===a[0]&&u.label<o[1]){u.label=o[1],o=a;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(a);break}o[2]&&u.ops.pop(),u.trys.pop();continue}a=r.call(e,u)}catch(i){a=[6,i],t=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}},n=this;exports.__esModule=!0;var t=require("./enframe"),o=require("./enframeConfig"),a=o.enframeConfig.appName,u=a+"-staging",i=a+"-prod",c=function(e){return t.commandDoesNotErrorAsync("heroku apps:info "+e)};function l(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];try{return[e.apply(null,r),null]}catch(t){return[null,t]}}exports.herokuChecker=function(){return e(n,void 0,Promise,function(){var e,n,o,a,l;return r(this,function(r){switch(r.label){case 0:return[4,t.commandDoesNotErrorAsync("heroku")];case 1:return e=r.sent(),n=[c(u),c(i)],[4,Promise.all(n)];case 2:return o=r.sent(),a=o[0],l=o[1],[2,{isHeroku:e,isStaging:a,isProd:l,shouldRunHerokuMaker:e&&!a&&!l}]}})})};var s=function(e){var r=l(t.enframeExec,"heroku apps:create "+e)[1];r&&t.elog("Failed to create "+e+"\n"+r);var n="heroku addons:create --app "+e+" heroku-postgresql:hobby-dev",o=l(t.enframeExec,n)[1];o&&t.elog("Failed to create database for "+e+"\n"+o)},f=function(e){if(o.enframeConfig.appCustomDomain){var r="heroku domains:add "+o.enframeConfig.appCustomDomain+" --app "+e,n=l(t.enframeExec,r),a=n[0],u=n[1];return u?(t.elog("Failed to create custom domain "+o.enframeConfig.appCustomDomain+"\n"+u),null):a}},p=function(e){return s(e)},h=function(e){return s(e),f(e)};exports.herokuMaker=function(e){if(e.shouldRunHerokuMaker)return p(u),h(i);t.elog("Skipping Heroku app creation.")};
},{"./enframe":"xsr0","./enframeConfig":"hz+C"}],"oP8S":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};exports.__esModule=!0;var t=e(require("react")),n=require("../enframeConfig"),a=function(){return t.default.createElement(t.default.Fragment,null,t.default.createElement("script",{dangerouslySetInnerHTML:{__html:"\n    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\n    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\n    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\n    })(window,document,'script','dataLayer','ENFRAME_GTM_ID');\n  "}}))};exports.Head=function(){return t.default.createElement("head",null,n.enframeConfig.gtmId&&t.default.createElement(a,null),t.default.createElement("link",{rel:"apple-touch-icon",sizes:"180x180",href:"images/apple-touch-icon.png"}),t.default.createElement("link",{rel:"icon",type:"image/png",sizes:"32x32",href:"images/favicon-32x32.png"}),t.default.createElement("link",{rel:"icon",type:"image/png",sizes:"16x16",href:"images/favicon-16x16.png"}),t.default.createElement("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),t.default.createElement("meta",{name:"description",content:"ENFRAME_APP_DESCRIPTION"}),t.default.createElement("link",{rel:"manifest",href:"/manifest.webmanifest"}),t.default.createElement("title",null,"ENFRAME_APP_NAME"),t.default.createElement("meta",{name:"theme-color",content:"#4285f4"}))};
},{"../enframeConfig":"hz+C"}],"RxGq":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};exports.__esModule=!0;var t=e(require("react")),r=require("../enframeConfig"),n=function(){return t.default.createElement(t.default.Fragment,null,t.default.createElement("noscript",null,t.default.createElement("iframe",{src:"https://www.googletagmanager.com/ns.html?id=ENFRAME_GTM_ID",height:"0",width:"0",style:{display:"none",visibility:"hidden"}})))},l=function(){return t.default.createElement(t.default.Fragment,null,t.default.createElement("script",{dangerouslySetInnerHTML:{__html:"\n// Check that service workers are supported\nif ('serviceWorker' in navigator) {\n  // Use the window load event to keep the page load performant\n  window.addEventListener('load', () => {\n    navigator.serviceWorker.register('/service-worker.js')\n  })\n}\n"}}))};exports.Body=function(){return t.default.createElement("body",null,r.enframeConfig.gtmId&&t.default.createElement(n,null),t.default.createElement("noscript",null,"This page requires Javascript to function correctly."),t.default.createElement("div",{id:"root"}),t.default.createElement("script",{src:"front/index.tsx"}),t.default.createElement("link",{rel:"stylesheet",href:"front/stylesheet.css"}),t.default.createElement(l,null))};
},{"../enframeConfig":"hz+C"}],"ZfiZ":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};exports.__esModule=!0;var t=e(require("react")),r=e(require("react-dom/server")),u=require("./Head"),l=require("./Body"),a=function(){return t.default.createElement("html",{lang:"en"},t.default.createElement(u.Head,null),t.default.createElement(l.Body,null))};exports.generateBaseIndexHtml=function(){return"<!DOCTYPE html>\n"+r.default.renderToStaticMarkup(t.default.createElement(a,null))};
},{"./Head":"oP8S","./Body":"RxGq"}],"J+wu":[function(require,module,exports) {
"use strict";exports.__esModule=!0;var e=require("fs"),r=require("./enframe"),n=require("./enframeConfig"),o=require("fs-extra"),i=require("./indexHtml/Html"),t=function(e){return r.enframeDir("srcapp/"+e)},c=function(e){return e.replace(/ENFRAME_APP_NAME/g,n.enframeConfig.appName).replace(/ENFRAME_APP_SHORT_NAME/g,n.enframeConfig.appShortName).replace(/ENFRAME_APP_DESCRIPTION/g,n.enframeConfig.appDescription).replace(/ENFRAME_GTM_ID/g,n.enframeConfig.gtmId)},s=function(n){var o=e.readFileSync(t(n),"utf8"),i=c(o);e.writeFileSync(r.rootDir(n),i)},a=function(){e.copyFileSync(t("gitignore"),r.rootDir(".gitignore")),s(".gitlab-ci.yml");var n=[".eslintrc.json",".mocharc.json",".prettierrc","cypress.json","nodemon.json","tsconfig.json"];n.forEach(function(n){e.copyFileSync(t(n),r.rootDir(n))});var o=n.concat([".gitignore",".gitlab-ci.yml"]);r.elog("Updated the following root files, "+o.join(", "))},f=function(){["src/","cypress/","scripts/"].forEach(function(e){o.copySync(t(e),r.rootDir(e)),r.elog("Copied the contents of "+t(e)+" into "+r.rootDir(e))})},p=function(){var n=i.generateBaseIndexHtml(),o=c(n);e.writeFileSync(r.rootDir("src/index.html"),o)},l=function(){["src/manifest.webmanifest","src/front/App.tsx","src/front/App.test.tsx","src/back/server.ts","cypress/integration/index.spec.js"].forEach(function(e){return s(e)})};exports.fileMaker=function(){a(),f(),l(),p()};
},{"./enframe":"xsr0","./enframeConfig":"hz+C","./indexHtml/Html":"ZfiZ"}],"xsr0":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,r,n,t){return new(n||(n=Promise))(function(o,i){function u(e){try{c(t.next(e))}catch(r){i(r)}}function a(e){try{c(t.throw(e))}catch(r){i(r)}}function c(e){e.done?o(e.value):new n(function(r){r(e.value)}).then(u,a)}c((t=t.apply(e,r||[])).next())})},r=this&&this.__generator||function(e,r){var n,t,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,t&&(o=2&i[0]?t.return:i[0]?t.throw||((o=t.return)&&o.call(t),0):t.next)&&!(o=o.call(t,i[1])).done)return o;switch(t=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,t=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=(o=u.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=r.call(e,u)}catch(a){i=[6,a],t=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},n=this;exports.__esModule=!0;var t=require("@aegatlin/pore"),o=require("path"),i=o.join(process.cwd(),"node_modules/enframe");exports.enframeDir=function(e){return o.join(i,e)},exports.rootDir=function(e){return o.join(process.cwd(),e)};var u=require("child_process"),a=require("./packageJson/packageJsonMaker"),c=require("./git"),s=require("./herokuMaker"),l=require("./fileMaker"),f=require("util");exports.elog=function(e){console.log("Enframe: "+e)},exports.enframeExec=function(e,r){exports.elog("Executing: "+e+"\n");var n={encoding:"utf8"};r&&(n.stdio="inherit");var t=u.execSync(e,n);t&&console.log(t)},exports.commandDoesNotError=function(e){try{return u.execSync(e,{encoding:"utf8",stdio:"ignore"}),!0}catch(r){return!1}},exports.commandDoesNotErrorAsync=function(o){return e(n,void 0,Promise,function(){var e,n;return r(this,function(r){switch(r.label){case 0:return e=f.promisify(u.exec),[4,t.pore(e(o))];case 1:return n=r.sent(),[2,!n[1]]}})})};var p=function(e){if(e){exports.elog("You have successfully created a custom domain. Use the information below to set up your domain DNS\n"+e)}exports.elog("You've been framed! Have a nice day :)")},h=function(){return e(n,void 0,void 0,function(){var e,n,t;return r(this,function(r){switch(r.label){case 0:return e=s.herokuChecker(),c.gitInit(),l.fileMaker(),a.packageJsonMaker(),t=s.herokuMaker,[4,e];case 1:return n=t.apply(void 0,[r.sent()]),c.gitPush(),p(n),process.exit(),[2]}})})};h();
},{"./packageJson/packageJsonMaker":"/QAH","./git":"ioA1","./herokuMaker":"i9Mb","./fileMaker":"J+wu"}]},{},["xsr0"], null)
//# sourceMappingURL=/enframe.js.map